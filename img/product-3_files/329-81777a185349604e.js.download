(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{74183:(e,t,r)=>{"use strict";r.d(t,{I5:()=>u,Pe:()=>d,YC:()=>c});var a=r(29022),i=r(85894),n=r(51913),o=r(7346);let s="/consumer/v2/loyalty-cards",l=(e,t)=>async()=>{let r="add"===t?n.A.gettext("consumer.grocery.loyalty_coop.card_added.toast"):n.A.gettext("consumer_grocery_loyalty_coop.card_unlinked.toast");return e((0,i.K)(r,"success",void 0,void 0,"CHECK")),await e((0,a.Xf)(!0)),e((0,a.r0)())},d=e=>({type:o.f2,endpoint:`${s}/${e}`}),u=(e,t)=>async r=>r({type:o.AN,endpoint:`${s}/${e}`,options:{method:"POST",body:{card_number:t}},onSuccess:l(r,"add")}),c=e=>async t=>t({type:o.we,endpoint:`${s}/${e}`,options:{method:"DELETE"},onSuccess:l(t,"remove")})},50647:(e,t,r)=>{"use strict";r.d(t,{A:()=>_});var a=r(62540),i=r(63696),n=r(40687),o=r(1969),s=r(69487),l=r(12330),d=r(58882),u=r(1561),c=r(43331),p=r(94943),g=r(53839),m=r.n(g);let _=e=>{let{children:t,tooltip:r,overrides:g}=e,_=(0,p.j)(),[v,h]=(0,i.useState)(!1),[f,I]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{let e=r.sessionReset?(0,l.isSessionStorageAvailable)():(0,l.isLocalStorageAvailable)(),t={};if(e){let e=(r.sessionReset?window.sessionStorage:window.localStorage).getItem(u.zk);e&&(t=JSON.parse(e))}if(r?.defaultOpenThreshold&&(-1===r.defaultOpenThreshold||void 0===t[r.key]||t[r.key]<r.defaultOpenThreshold)){if(e){let e=r.sessionReset?window.sessionStorage:window.localStorage;t[r.key]=(t[r.key]??0)+1,e.setItem(u.zk,JSON.stringify(t))}r.trackingId&&_((g?.withoutTrigger?c.Kt:c.NC)(r.trackingId)),h(!0)}I(!1)},[r.defaultOpenThreshold,r.key,r.sessionReset,r.trackingId,g?.withoutTrigger,_]),f)?null:(0,a.jsx)("span",{className:m().popoverWrapper,children:(0,a.jsx)(s.A,{renderContent:()=>(0,a.jsx)("div",{className:m().popoverInner,children:(0,a.jsx)(n.default,{spacing:"medium",color:"white",colorToken:"foreground-neutral-normal-on-neutral-intense",children:r.text})}),renderTrigger:e=>(0,a.jsx)(d.A,{condition:!g?.withoutTrigger,wrapper:t=>(0,a.jsx)(o.default,{onClick:e,outlineRadius:"circle",children:t}),children:(0,a.jsx)(a.Fragment,{children:t})}),align:g?.align||"right",rightOffset:g?.rightOffset!==void 0?g.rightOffset:-40,defaultOpen:v,theme:"dark",position:g?.position})})}},27817:(e,t,r)=>{"use strict";r.d(t,{Hz:()=>I,$S:()=>w,wX:()=>R});var a=r(62540),i=r(63696),n=r(62688),o=r.n(n),s=r(72831),l=r(18928),d=r(37433),u=r(1561),c=r(85022),p=r(92390),g=r(97100),m=r(29022),_=r(94943);let v=(e,t,r,a)=>{let n=(0,_.j)(),{hasFetched:o,hasError:s}=(0,g.A)(),l=(0,c.d4)(p.qx),d=(0,c.d4)((0,p.vA)(e)),u=(0,c.d4)(p.ks);return(0,i.useEffect)(()=>{(l||d)&&a&&o&&!s&&n((0,m.gf)(e,t,r))},[l,d,a,e,t,r,n,o,s]),u};var h=r(19953);let f="item-id",I=(0,i.createContext)(),R=()=>(0,i.useContext)(I)??{},w=e=>{let{children:t}=e,r=(0,s.useRouter)(),n=(0,h.Ay)(),o=r.query[f],[c,p]=(0,i.useState)(o?{source:u.mU.DEEPLINK,itemId:o}:null),{menuItem:g,isLoading:m,hasError:_}=(0,l.A)(c?.itemId),R=!!g||m||_,w=v(g?.id,g?.uid,g?.drnUid,R),[y,E]=(0,i.useState)([]),O=c?.itemId===o;return(0,i.useEffect)(()=>{if(!O){if(R){let e={[f]:c.itemId},{url:t,as:a,locale:i}=n.getLinkParams((0,d.oG)(r.asPath,e));r.replace(t,a,{shallow:!0,locale:i})}else if(o){let{url:e,as:t,locale:a}=n.getLinkParams((0,d.mo)(r.asPath,[f]));r.replace(e,t,{shallow:!0,locale:a})}}},[R,O]),(0,a.jsx)(I.Provider,{value:{menuItemModal:g,trackingId:c?.trackingId,triggerOrigin:c?.source,isSponsored:c?.isSponsored,trackingProperties:c?.trackingProperties,preselectedModifiers:c?.preselectedModifiers,preselectedQuantity:c?.preselectedQuantity,adServeId:c?.adServeId,showMenuItemModal:R,setMenuItemModal:p,isLoading:m,hasError:_,itemDetailsPage:w,menuItemModifierModal:y,setMenuItemModifierModal:E},children:t})};w.propTypes={children:o().node.isRequired}},30064:(e,t,r)=>{"use strict";r.d(t,{K4:()=>s,rb:()=>o});var a=r(62540),i=r(63696);let n=(0,i.createContext)({}),o=()=>(0,i.useContext)(n),s=e=>{let{children:t}=e,[r,o]=(0,i.useState)(null),s=r?{}:void 0;return(0,a.jsx)(n.Provider,{value:{modalContent:s,showMultiPartnerOrderingModal:!!s,setMultiPartnerOrderingModal:o},children:t})}},55178:(e,t,r)=>{"use strict";r.d(t,{Vp:()=>l,gR:()=>d});var a=r(62540),i=r(63696),n=r(85022),o=r(92390);let s=(0,i.createContext)({}),l=()=>(0,i.useContext)(s),d=e=>{let{children:t}=e,[r,l]=(0,i.useState)(null),d=(0,n.d4)((0,o.H7)(r));return(0,a.jsx)(s.Provider,{value:{pastOrder:d,showPastOrderModal:!!d,setReorderModalId:l},children:t})}},32019:(e,t,r)=>{"use strict";let a;r.d(t,{A:()=>c});var i=r(63696),n=r(85022),o=r(70897),s=r(29022),l=r(92390),d=r(94943);let u=[],c=e=>{let t=(0,d.j)(),r=(0,n.d4)((0,l.Xh)(e.filter(Boolean))),c=!!r.length,p=e=>new Promise(r=>{a&&clearTimeout(a),u.push(...e),a=setTimeout(()=>{t((0,s.uU)([...new Set(u)])).then(r),u=[],a=null},0)}),[g,m]=(0,o.A)(async()=>p(r),[r.join()]),_=g.loading,v=!c||"value"in g;return(0,i.useEffect)(()=>{!c||_||v||m()},[c,_,v,m]),{isLoading:_,hasFetched:v}}},18928:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(85022),i=r(92390),n=r(32019);let o=function(e){let{withCategory:t,itemDetailsOverride:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{withCategory:!1,itemDetailsOverride:!1},o=(0,a.d4)((0,i.Jp)(e,t)),s=(0,a.d4)((0,i.gW)(e)),{isLoading:l,hasFetched:d}=(0,n.A)(r?[]:[e]),u=!!e&&!o&&d;return{menuItem:r?s:o,isLoading:l,hasFetched:d,hasError:u}}},60061:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>R,I$:()=>I,k0:()=>f});var a=r(72831),i=r(91629),n=r(64527),o=r(44038),s=r(1561),l=r(40115),d=r(27817),u=r(55178),c=r(9879),p=r(16097),g=r(19953),m=r(94943),_=r(3227),v=r(74183),h=r(30064);let f={typeName:s.qY.ACTION,action:s.lv.CLEAR_FILTERS},I=e=>!!e&&!(e.typeName===s.qY.ACTION&&e.action===s.lv.NOOP),R=()=>{let e=(0,m.j)(),t=(0,a.useRouter)(),r=(0,g.Ay)(),f=(0,p.A)(),{setMenuItemModal:R}=(0,d.wX)(),{setMultiPartnerOrderingModal:w}=(0,h.rb)(),{setReorderModalId:y}=(0,u.Vp)(),{setLayoutView:E}=(0,c.M)();return a=>{if(!I(a))return null;let d=f(a);switch(a.typeName){case s.qY.ACTION:switch(a.action){case s.lv.CLEAR_FILTERS:{let{as:e,url:a,locale:i}=r.getLinkParams(d);t.push(a,e,{scroll:!1,locale:i});break}case s.lv.SCROLL_TO_LAYOUT:{let e=document.querySelector(`#${a.layoutId}`);if(!e)return Promise.reject();return(0,i.default)(e,{padding:{top:(0,l.d2)()}})}case s.lv.SHOW_MODAL:a.layoutId&&E(a.layoutId,a.action);break;case n.lS.SHOW_TARGET_MODAL:a.layoutId&&e((0,_.t5)(a.layoutId));break;case s.lv.SHOW_REVIEW_MODAL:e((0,o.Ul)(!0));break;case s.gg:if(void 0!==a.params&&null!==a.params){for(let e of a.params)if("plus_offer_source"===e.id&&1===e.value.length)return window.location.href=`/plus?utm_source=${e.value[0]}`,null}window.location.href="/plus?utm_source=menu";break;case s.lv.PHONE_CALL:d&&(window.location.href=d)}break;case s.qY.SHOW_SECTION:if(d){let{as:e,url:a,locale:i}=r.getLinkParams(d);return t.push(a,e,{scroll:!1,locale:i})}break;case s.qY.MENU_ITEM:R({itemId:a.menuItemId});break;case s.qY.REORDER:y(a.orderId);break;case s.qY.WEB_PAGE:d&&(a.newWindow?window.open(d,"_blank"):window.location.href=d);break;case s.qY.PARTNER_MENU:d&&r.getRouteHandler(d)();break;case s.qY.LOYALTY_MODAL:e((0,v.Pe)(a.partnerDrnId));break;case s.qY.MULTI_PARTNER_ORDERING_MODAL:w(a.partnerDrnId)}return null}}},16097:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var a=r(72831),i=r(85022),n=r(74444),o=r(37433),s=r(90509),l=r(1561),d=r(40115),u=r(92390);let c=e=>{let{pathname:t,search:r}=new n.Ay(e);return`${t}${r}`},p=()=>{let e=(0,a.useRouter)(),t=(0,i.d4)(u.W8),r=(0,i.d4)(s.bp),n=t?.links?.self?.href,p=e.asPath.startsWith("/menu")?r:n;return e=>{switch(e?.typeName){case l.qY.ACTION:switch(e.action){case l.lv.CLEAR_FILTERS:return c((0,o.oG)((0,o.mo)(p,l.cw),(0,d.sA)(e.params||[])));case l.lv.PHONE_CALL:if(Array.isArray(e.params))return`tel:${e.params[0].value[0]}`}break;case l.qY.SHOW_SECTION:if(Array.isArray(e.sectionParams))return c((0,o.oG)((0,o.mo)(p,l.cw),(0,d.sA)(e.sectionParams)));break;case l.qY.WEB_PAGE:return e.url;case l.qY.PARTNER_MENU:return n}}}},2304:(e,t,r)=>{"use strict";r.d(t,{oX:()=>L,C8:()=>x,n3:()=>P,_M:()=>U,k_:()=>M,vM:()=>S,Q8:()=>b});var a=r(99880),i=r(65854),n=r(96689),o=r(97723),s=r(7083),l=r(81153),d=r(63769),u=r(29543);let c=`
  fragment uiRatingViewFields on UIRatingView {
    typeName: __typename
    ... on UIModalRatingView {
      title
      subtitle
      navigationAction: navigation_action {
        text
        target {
          ...uiTargetFields
        }
      }
      progress {
        ...uiProgressBarFields
      }
      buttons {
        ...uiModalButtonFields
      }
      layout {
        ...layoutFields
      }
      meta {
        orderId: order_id
        requestUUID: request_uuid
        trackingUUID: tracking_uuid
        translationLanguage: localizer_language
        acceptLanguage: accept_language
        reviewId: review_id
      }
      preferences {
        showTermsMessage: show_terms_message
        options {
          id
          selected
          name: label
          required
        }
      }
    }
    ... on UIBottomSheetRatingView {
      image {
        ... on UIModalImage {
          url: image
        }
        ... on DeliverooIllustrationBadge {
          name
        }
      }
      layout {
        ...layoutFields
      }
      meta {
        orderId: order_id
        requestUUID: request_uuid
        trackingUUID: tracking_uuid
        translationLanguage: localizer_language
        acceptLanguage: accept_language
        reviewId: review_id
      }
    }
  }
`,p=`
  fragment uiProgressBarFields on UIProgressBar {
    steps
    currentStep: current_step
    activeColor: active_color {
      ...colorFields
    }
    inactiveColor: inactive_color {
      ...colorFields
    }
  }
`,g=`
  fragment layoutFields on UIRatingViewLayout {
    typeName: __typename
    ... on UIRatingInputLayout {
      title
      subtitle
      footnote
      image {
        typeName: __typename
        ... on UIModalImage {
          url: image
        }
        ... on DeliverooIllustrationBadge {
          name
        }
      }
      inputs {
        ...uiRatingInputFields
      }
    }
    ... on UIRatingBannerLayout {
      title
      subtitle
      footnote
      bannerImage: image {
        typeName: __typename
        ... on UIModalImage {
          url: image
        }
        ... on DeliverooIllustrationBadge {
          name
        }
      }
    }
  }
`,m=`
  fragment uiModalButtonFields on UIModalButton {
    title
    uiTheme: ui_theme
    dismissOnAction: dismiss_on_action
    target {
      ...uiTargetFields
    }
  }
`,_=`
  fragment uiRatingInputFields on UIRatingInput {
    typeName: __typename
    ... on UIStarRatingInput {
      footnote
      starOptions: star_options {
        value
        selectedColor: selected_color {
          ...colorFields
        }
      }
      target {
        ...uiTargetFields
      }
      fieldName: field_name
      starValue: value
      label
      metadata {
        id
        value
      }
    }
    ... on UISelectListInput {
      label
      type
      options {
        ...uiSelectOptionFields
      }
      fieldName: field_name
      selectValue: value
      limit {
        text
        limitAt: limit_at
      }
    }
    ... on UITextAreaInput {
      label
      fieldName: field_name
      textValue: value
      placeholder
      footnote
    }
  }
`,v=`
  fragment uiSelectOptionFields on UISelectOption {
    id
    default
    disabled
    selected
    label
    icon {
      ...deliverooIconFields
    }
    style {
      ...uiSelectOptionStyleFields
    }
  }
`,h=`
  fragment uiTargetFields on UITarget {
    typeName: __typename
    ... on UITargetMutation {
      mutation
      params {
        id
        value
      }
    }
  }
`,f=`
  fragment uiSelectOptionStyleFields on UISelectOptionStyle {
    backgroundColor: background_color {
      ...colorFields
    }
    textColor: text_color {
      ...colorFields
    }
    selectedBackgroundColor: selected_background_color {
      ...colorFields
    }
    selectedTextColor: selected_text_color {
      ...colorFields
    }
  }
`,I=`
  fragment deliverooIconFields on DeliverooIcon {
    name
    image
  }
`,R=`
  query get_order_rating_view(
    $orderId: String
    $requestUUID: String!
    $trackingUUID: String!
    $source: String!
    $include_token: Boolean!
  ) {
    results: get_order_rating_view(
      order_id: $orderId
      request_uuid: $requestUUID
      tracking_uuid: $trackingUUID
      source: $source
    ) {
      ...uiRatingViewFields
    }
  }

  ${c}
  ${p}
  ${_}
  ${m}
  ${g}
  ${v}
  ${f}
  ${h}
  ${I}
  ${l.gT}
`,w=`
  query get_manage_review($id: String!, $trackingUUID: String!, $include_token: Boolean!) {
    manageReview: get_manage_review(id: $id, tracking_uuid: $trackingUUID) {
      title
      layout {
        title
        image {
          ... on Image {
            url
            altText: alt_text
          }
        }
        review {
          ...uiPartnerReview
        }
      }
      meta {
        trackingId: tracking_id
        orderId: order_id
      }
    }
  }

  ${l.gT}
  ${d.H}
  ${u.Z}
  ${s.$r}
  ${s.AW}
  ${s.r6}
`,y=`
  mutation submit_order_rating(
    $input: OrderRatingInput!
    $requestUUID: String!
    $trackingUUID: String!
    $source: String!
    $include_token: Boolean!
  ) {
    results: submit_order_rating(
      request_uuid: $requestUUID
      tracking_uuid: $trackingUUID
      input: $input
      source: $source
    ) {
      ...uiRatingViewFields
    }
  }

  ${c}
  ${p}
  ${_}
  ${m}
  ${g}
  ${v}
  ${f}
  ${h}
  ${I}
  ${l.gT}
`;var E=r(84750),O=r(46373);let T={[O.Z.HOME]:"home_prompt",[O.Z.ORDER_HISTORY]:"order_history"},k=e=>{let{orderId:t,trackingUUID:r,dismissed:a=!1,formData:i,extraProps:n={},source:o}=e;return(e,s)=>{let l=s(),d=T[o];return e({type:E.pF,payload:{name:"SAW_REVIEW_MODAL",properties:{"Review ID":r,"Order ID":t,dismissed:a,stars:l.orderRating.selectedStarRating,"Rating screen seen":i[0]?.field_name,"Viewed tags":n.viewedTags,"Tapped view more count":n.tappedViewMoreCount,Entrypoint:d}}})}};var A=r(66764);let S=e=>{let{isReviewable:t,orderId:r,selectedStar:a}=e;return(e,i)=>{let n=i(),s=(0,A.f_)(n);return e({type:o.uQ,payload:{orderId:r||s,reviewable:t,selectedStar:a}})}},x=function(){let{orderId:e,source:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(r,s)=>r({type:o.Hu,endpoint:"/consumer/graphql/",options:{method:"POST",body:{variables:{orderId:e,requestUUID:(0,a.A)(),trackingUUID:(0,a.A)(),source:t,include_token:(0,i.iM)(s(),n.COLOR_TOKENS_MVT,"feature")},query:R}}})},b=function(){let{orderId:e="",formData:t=[],params:r=[],trackingUUID:s,dismissed:l=!1,preferences:d,trackingProperties:u={},source:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(p,g)=>{let m=g(),_=(0,A.mr)(m);return p(k({orderId:e,trackingUUID:s,dismissed:l,formData:t,extraProps:u,source:c})),p({type:o.WQ,endpoint:"/consumer/graphql/",options:{method:"POST",body:{variables:{input:{order_id:e,form_data:t,params:r,dismissed:l,preferences:d},requestUUID:(0,a.A)(),trackingUUID:s,source:c,include_token:(0,i.iM)(m,n.COLOR_TOKENS_MVT,"feature")},query:y}}}).then(()=>{if(c===O.Z.ORDER_HISTORY){let e=g(),t=(0,A.f_)(e);t&&p(S({isReviewable:!1,orderId:t,selectedStar:_}))}}).catch(e=>{let t=e.status||500,r=e.data||{};return p({type:o.Xn,status:t,message:r.message||e.message,payload:{...r}})}).catch(e=>{let t=e.status||500,r=e.data||{};return p({type:o.Xn,status:t,message:r.message||e.message,payload:{...r}})})}},L=e=>(t,r)=>t({type:o.PQ,endpoint:"/consumer/ugc-service/graphql/",options:{method:"POST",body:{variables:{id:e,trackingUUID:(0,a.A)(),include_token:(0,i.iM)(r(),n.COLOR_TOKENS_MVT,"feature")},query:w}}}),U=e=>({type:o.Jr,payload:{isOpen:e}}),M=e=>({type:o.eR,payload:{selectedStarRating:e}}),P=e=>({type:o.YE,payload:{isOpen:e}})},46373:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var a=function(e){return e.HOME="home-page",e.ORDER_HISTORY="order-history",e}({})},66764:(e,t,r)=>{"use strict";r.d(t,{Dv:()=>l,HL:()=>d,RQ:()=>u,bR:()=>o,f3:()=>m,f_:()=>p,ho:()=>v,kF:()=>n,mr:()=>_,n_:()=>g,oX:()=>s,vG:()=>f,z6:()=>c});var a=r(5762),i=r(7922);let n=(0,a.Mz)(e=>e.orderRating,e=>e.isModalOpen),o=(0,a.Mz)(e=>e.orderRating,e=>e.isManageModalOpen),s=(0,a.Mz)(e=>e.orderRating,e=>e.manageReview),l=(0,a.Mz)(e=>e.orderRating,e=>e.manageReview?.meta?.orderId),d=(0,a.Mz)(e=>e.orderRating,e=>e.ratingView),u=(0,a.Mz)(e=>e.orderRating,e=>e.isLoading),c=(0,a.Mz)(e=>e.orderRating,e=>e.trackedReviews),p=(0,a.Mz)(e=>e.orderRating,e=>e.ratingView?.meta?.orderId),g=(0,a.Mz)(e=>e.orderRating,e=>e.ratingView?.meta?.requestUUID),m=(0,a.Mz)(e=>e.orderRating,e=>e.ratingView?.meta?.trackingUUID),_=(0,a.Mz)(e=>e.orderRating,e=>e.selectedStarRating),v=(0,a.Mz)([e=>e.orderRating],e=>({translationLanguage:e.ratingView?.meta?.translationLanguage,acceptLanguage:e.ratingView?.meta?.acceptLanguage})),h=[e=>{let{errors:t}=e;return!!t.network&&t.network?.status===422&&new i.eO(`Invalid UGC GraphQL request. ${t.network.errors[0].message}`)},e=>{let{errors:t}=e;return!!t.network&&t.network?.status!==200&&new i.Dr(`Network Error for UGC API: HTTP ${t.network.status} - ${t.network.message}`)},e=>{let{errors:t}=e;return t.graphql.length>0&&new i.eO(`UGC GraphQL Error. ${t.graphql[0].message}`,t.graphql[0].extensions)}],f=(0,a.Mz)(e=>e.orderRating,e=>h.map(t=>t(e)).find(Boolean))},44038:(e,t,r)=>{"use strict";r.d(t,{CV:()=>O,Bt:()=>T,PH:()=>L,Ul:()=>b,eP:()=>k,lS:()=>x});var a=r(99880),i=r(2304),n=r(66764),o=r(46373),s=r(65854),l=r(96689),d=r(31236),u=r(29543),c=r(63769),p=r(81153),g=r(7083);let m=`
  query get_partner_reviews(
    $options: SearchOptionsInput!
    $trackingUUID: String!
    $include_token: Boolean!
  ) {
    reviewData: get_partner_reviews(options: $options, tracking_uuid: $trackingUUID) {
      layouts: ui_review_layouts {
        typeName: __typename
        ... on PartnerReviewsLayout {
          title
          sortOptions: sort_options {
            selected
            target {
              ...uiTargetFields
            }
          }
          reviews {
            ...uiPartnerReview
          }
        }
        ... on PartnerRatingBreakdownLayout {
          title
          ratingBreakdown: rating_breakdown {
            averageRating: average_rating
            color: rating_color {
              ...colorFields
            }
            numberOfStars: number_of_stars
            totalStars: total_stars
            reviewCount: review_count
            ratingBreakdownRows: rating_breakdown_rows {
              number
              percent
              color {
                ...colorFields
              }
            }
          }
        }
        ... on PartnerReviewsButtonLayout {
          title
          button {
            text
            uiTarget: target {
              ...uiTargetFields
            }
            uiTheme: ui_theme
          }
        }
      }
      meta {
        trackingId: tracking_id
        partnerDrnId: partner_drn_id
        appliedSort: applied_sort
      }
    }
  }

  ${p.gT}
  ${g.r6}
  ${g.AW}
  ${g.$r}
  ${u.Z}
  ${c.H}
`,_=`
  mutation deleteReview($id: String!) {
    id: delete_partner_review(id: $id)
  }
`,v=`
  mutation reportReview($id: String!) {
    PartnerReviewReport: report_partner_review(id: $id) {
      reviewId: review_id
    }
  }
`,h=`
  mutation voteReview($params: [ParamInput!]) {
    voteResult: vote_review(params: $params) {
      reviewDrnId: review_drn_id
      state
    }
  }
`;var f=r(2839),I=r(17368),R=r(48768);let w=e=>({type:d.JF.SET_VIEWED_MODAL_ID,payload:{viewedModalId:e}}),y=e=>t=>{let r=e.status||500,a=e.data||{};return t({type:d.JF.GET_ORDER_REVIEWS_QUERY_FAILURE,status:r,message:a.message||e.message,payload:{...a}})},E=e=>({type:d.JF.SET_SELECTED_PARAMS,payload:{params:e}}),O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return async(i,n)=>{await i(E(t));try{await i({type:d.JF.GET_ORDER_REVIEWS_QUERY,endpoint:"/consumer/ugc-service/graphql/",options:{method:"POST",body:{variables:{options:{partner_drn_id:e,pagination:{limit:50,offset:0},params:t},trackingUUID:(0,a.A)(),include_token:(0,s.iM)(n(),l.COLOR_TOKENS_MVT,s.lJ.FEATURE)},query:m}}});let o=n(),u=(0,R.f3)(o);i(w(u)),r&&i((0,I.dC)(e,u))}catch(e){y(e)}}},T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{limit:50,offset:0};return(t,r)=>{let i=r(),n=(0,R.Pl)(i),o=(0,R.eG)(i),u=(0,R.Ax)(i);try{i=r();let c=(0,R.f3)(i);t((0,I.yz)(o,c,e,n)),t({type:d.JF.GET_PAGINATED_ORDER_REVIEWS_QUERY,endpoint:"/consumer/ugc-service/graphql/",options:{method:"POST",body:{variables:{options:{partner_drn_id:o,pagination:e,params:u},trackingUUID:(0,a.A)(),include_token:(0,s.iM)(i,l.COLOR_TOKENS_MVT,s.lJ.FEATURE)},query:m}}})}catch(e){y(e)}}},k=(e,t)=>({type:d.JF.SET_IS_REVIEW_TOAST_OPEN,payload:{isToastOpen:e,toastActionSource:t}}),A=(e,t)=>(r,a)=>{let s=a(),l=(0,n.Dv)(s);return r(k(!0,f.oj.DELETE)),t===o.Z.ORDER_HISTORY&&r((0,i.vM)({isReviewable:!0,orderId:l})),r({type:d.JF.DELETE_REVIEW_MUTATION,endpoint:"/consumer/ugc-service/graphql/",options:{method:"POST",body:{variables:{id:e},query:_}}})},S=e=>t=>(t(k(!0,f.oj.REPORT)),t({type:d.JF.REPORT_REVIEW_MUTATION,endpoint:"/consumer/ugc-service/graphql/",options:{method:"POST",body:{variables:{id:e},query:v}}})),x=(e,t)=>r=>r({type:d.JF.VOTE_REVIEW_MUTATION,endpoint:"/consumer/ugc-service/graphql/",options:{method:"POST",body:{variables:{params:e},query:h}},onSuccess:e=>{if(!e?.payload?.data?.voteResult?.reviewDrnId||e?.payload?.errors?.length)throw Error("Failed to vote");return t()}}),b=e=>({type:d.JF.SET_IS_REVIEW_MODAL_OPEN,payload:{isModalOpen:e}}),L=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return r=>{switch(e.mutation){case d.If.DELETE_REVIEW:r(A(e.id,t));break;case d.If.REPORT_REVIEW:r(S(e.id))}}}},7083:(e,t,r)=>{"use strict";r.d(t,{$r:()=>s,AW:()=>o,r6:()=>n});var a=r(2e3),i=r(29543);let n=`
  fragment uiPartnerReview on PartnerReview {
    id
    reviewer {
      username
      displayName: display_name
      avatar {
        ... on Image {
          url
          altText: alt_text
        }
      }
    }
    tags {
      text
      backgroundColor: background_color {
        ...colorFields
      }
      textColor: text_color {
        ...colorFields
      }
      icon {
        name
      }
    }
    textComment: text_comment
    starRating: star_rating {
      totalStars: total_stars
      appliedStars: applied_stars
      color {
        ...colorFields
      }
    }
    date
    uiTargets: ui_targets {
      ...uiTargetFields
    }
    voteUi: vote_ui {
      defaultLine: ui_line {
        ...uiLineFields
      }
      state
      actions {
        icon {
          ...iconFields
        }
        line: ui_line {
          ...uiLineFields
        }
        state
        descriptor
        selectedIconColor: selected_icon_color {
          ...colorFields
        }
        unselectedIconColor: unselected_icon_color {
          ...colorFields
        }
        target {
          params {
            id
            value
          }
          displayName: display_name
          mutation
        }
      }
    }
  }
`,o=`
  ${a.q}
  fragment uiTargetFields on UITarget {
    ...baseUiTargetFields
    ... on UITargetAction {
      displayName: display_name
    }
  }
`,s=`
  ${i.p}
  fragment uiSpanFields on UISpan {
    ...baseUiSpanFields
  }
`},48768:(e,t,r)=>{"use strict";r.d(t,{Ax:()=>v,H7:()=>_,OA:()=>u,Pl:()=>p,RQ:()=>g,eG:()=>c,f3:()=>d,gS:()=>m,kF:()=>n,mq:()=>s,yf:()=>o});var a=r(5762),i=r(80886);let n=(0,a.Mz)(e=>e.orderReviews,e=>e.isModalOpen),o=(0,a.Mz)(e=>e.orderReviews,e=>e.layouts),s=(0,a.Mz)(e=>e.orderReviews,e=>e.hiddenReviews),l=(0,a.Mz)(e=>e.orderReviews,e=>e.meta),d=(0,a.Mz)(l,e=>e?.trackingId),u=(0,a.Mz)(l,e=>e?.appliedSort),c=(0,a.Mz)(l,e=>e?.partnerDrnId),p=(0,a.Mz)(e=>e.orderReviews,e=>e.viewedModalId),g=(0,a.Mz)(e=>e.orderReviews,e=>e.isLoading),m=(0,a.Mz)(e=>e.orderReviews,e=>e.isToastOpen),_=(0,a.Mz)(e=>e.orderReviews,e=>e.toastActionSource);(0,a.Mz)(e=>e.orderReviews,e=>e.pagination),(0,a.Mz)([e=>e.menuPage.scrollTracking[i.SW.REVIEW_MODAL]],e=>e.elements);let v=(0,a.Mz)(e=>e.orderReviews,e=>e.selectedParams)},17368:(e,t,r)=>{"use strict";r.d(t,{DO:()=>g,Hp:()=>u,bK:()=>c,dC:()=>l,dx:()=>p,yz:()=>d});var a=r(50556),i=r(80886),n=r(84750),o=r(37050),s=r(48768);let l=(e,t)=>r=>r({type:n.pF,payload:{name:"Viewed Restaurant Review Modal",properties:{restaurant_drn_id:e,served_reviews_tracking_id:t}}}),d=(e,t,r,a)=>i=>i({type:n.pF,payload:{name:"Tapped Load More Reviews",properties:{restaurant_drn_id:e,served_reviews_tracking_id:t,requested_limit:r.limit,requested_offset:r.offset,viewed_modal_event_id:a}}}),u=(e,t)=>async(r,l)=>{let d=l(),u=(0,s.Pl)(d),{properties:c,name:p}=(0,a.Hz)({source:i.SW.REVIEW_MODAL,name:"Closed Restaurant Review Modal"});return await r({type:n.pF,payload:{name:p,properties:{restaurant_drn_id:e,served_reviews_tracking_id:t,viewed_items:c["Viewed Items"],viewed_modal_event_id:u}}}),(0,o.W.dispatch)((0,a.Rj)(i.SW.REVIEW_MODAL))},c=(e,t)=>r=>r({type:n.pF,payload:{name:"Viewed Sort Review Menu",properties:{restaurant_drn_id:e,served_reviews_tracking_id:t}}}),p=(e,t,r)=>a=>a({type:n.pF,payload:{name:"Tapped Sort Review Option",properties:{restaurant_drn_id:e,served_reviews_tracking_id:t,sort_by:r.toString()}}}),g=e=>(t,r)=>{let a=r(),i=(0,s.eG)(a),o=(0,s.f3)(a);return t({type:n.pF,payload:{name:"Tapped Review Block",properties:{restaurant_drn_id:i,served_reviews_tracking_id:o,review_id:e.reviewId,event:e.event}}})}},40329:(e,t,r)=>{"use strict";r.r(t),r.d(t,{UILinesWithMenuTargetHandler:()=>Q,UILinesWithSharedTargetHandler:()=>Z,WithMenuTargetHandler:()=>X,WithSharedTargetHandler:()=>K,default:()=>ee});var a=r(62540),i=r(4452),n=r.n(i),o=r(32545),s=r(40687),l=r(71681),d=r(58882),u=r(22582),c=r.n(u);let p={X_SMALL:"x-small",SMALL:"small",MEDIUM:"medium",LARGE:"large"},g=e=>p[e]||"x-small",m=e=>e?.hex||"initial",_=e=>{let{text:t,color:r,size:i,textSizeOverride:o,isPlaceholder:u,maxLines:p,isHeading:_,level:v=2,noList:h,children:f}=e;return(0,a.jsx)(d.A,{condition:!h,wrapper:e=>(0,a.jsx)("li",{className:n()({[c().uiLineClamp]:!!p}),style:{...p&&{"--max-lines":p}||{}},children:e}),children:(0,a.jsx)("span",{style:{color:m(r)},children:_?(0,a.jsx)(l.default,{size:o||g(i),level:v,isPlaceholder:u,children:p?(0,a.jsxs)("div",{className:c().headingWithLineClamp,children:[(0,a.jsx)("div",{className:n()({[c().uiLineClamp]:!!p}),style:{...p&&{"--max-lines":p}||{}},children:t}),f]}):(0,a.jsxs)(a.Fragment,{children:[t,f]})}):(0,a.jsx)(s.default,{size:"regular",isBold:!0,children:t})})})};var v=r(40115),h=r(1561),f=r(62688),I=r.n(f),R=r(84178),w=r(14037),y=r(52261),E=r(1969),O=r(34258),T=r(71991),k=r(63364),A=r(51913),S=r(50647),x=r(47634);r(63696);var b=r(7966),L=r(26752),U=r(54345),M=r.n(U),P=r(39128);function $(e){let{backgroundColor:t,spans:r,target:i}=e,n=(0,b.useTokensTheme)(),o=(0,P.e)(i);return(0,a.jsx)("span",{className:M().uiSpanTag,onClick:o,onKeyDown:o?(0,L.c)(o):void 0,role:o?"button":void 0,style:{backgroundColor:(0,x.$s)(t,n),whiteSpace:"pre",lineHeight:"24px"},tabIndex:o?0:void 0,children:(0,a.jsx)(W,{spans:r})})}let C={HEADING_X_SMALL:{level:4,size:"x-small"},HEADING_SMALL:{level:3,size:"small"},HEADING_MEDIUM:{level:2,size:"medium"},HEADING_LARGE:{level:1,size:"large"},BRAND_MEDIUM:{level:2,size:"medium",isBrand:!0},BRAND_LARGE:{level:1,size:"large",isBrand:!0},BRAND_X_LARGE:{level:1,size:"x-large",isBrand:!0}},D=e=>{let{key:t,text:r,size:i,color:n,isBold:o,sizeOverride:s,colorName:u,isStrikethrough:c,isItalic:p}=e,g=n?.token;switch(i){case"X_SMALL":case"SMALL":case"MEDIUM":{let e=c?{color:n.hex,textDecorationColor:n.hex,textDecoration:"inherit"}:{color:n.hex};return()=>(0,a.jsx)(w.default,{size:s||h.p7[i],isBold:o,isStrikethrough:c,...(0,x.v)(n),children:(0,a.jsx)(d.A,{condition:!u&&!g,wrapper:t=>(0,a.jsx)("span",{style:e,children:t}),children:r})},t)}case"HEADING_X_SMALL":case"HEADING_SMALL":case"HEADING_MEDIUM":case"HEADING_LARGE":case"BRAND_MEDIUM":case"BRAND_LARGE":case"BRAND_X_LARGE":return()=>(0,a.jsx)("span",{style:{color:n.hex},children:(0,a.jsx)(d.A,{condition:!!g,wrapper:e=>(0,a.jsx)(w.default,{colorToken:g,children:e}),children:(0,a.jsx)(l.default,{level:C[i].level,color:g?null:u||"inherit",colorToken:(0,x.eA)(g),size:C[i].size,isBrand:C[i]?.isBrand,isItalic:p,children:r},t)})});default:return()=>null}},N=e=>{let{spans:t,sizeOverride:r,handleTarget:i=(e,t)=>({target:e,trackingId:t})}=e;return t?.map((e,t)=>{let{key:n,typeName:s,text:l,size:u,color:c,icon:p,target:g,width:m,isBold:_,endsAt:v,trackingId:f,plusLogoColor:I,plusLogoSize:R,iconTooltip:b,uiSpans:L,spanIcon:U,backgroundColor:P,isStrikethrough:C=!1}=e,N=T.$J[c?.name],j=T.$J[I?.name],F=c?.token;switch(s){case h.RE.TEXT:return a.jsx(d.A,{condition:"\xb7"===l.trim(),wrapper:e=>a.jsx("span",{"aria-hidden":!0,children:e}),children:a.jsx(d.A,{condition:!!g,wrapper:e=>a.jsx(E.default,{onClick:()=>i(g,f),children:e}),children:D({...e,sizeOverride:r,colorName:N,isStrikethrough:C})()})},`${n}-${t}`);case h.RE.ICON:{let e=p||U;if(!e)return null;return a.jsx(d.A,{condition:!!b,wrapper:e=>a.jsx(S.A,{tooltip:b,children:e}),children:a.jsx(d.A,{condition:!!g,wrapper:e=>a.jsx(E.default,{onClick:()=>i(g,f),children:e}),children:a.jsx(k.Ay,{name:e.name,size:e.size,color:e.color,backgroundColor:e.backgroundColor})})},`${n}-${t}`)}case h.RE.PLUS_LOGO:return a.jsx(d.A,{condition:!!I,wrapper:e=>j?a.jsx(w.default,{color:j,children:e}):a.jsx("span",{style:{color:I.hex},children:e}),children:a.jsx(O.default,{className:M().plusLogo,ariaLabel:A.A.gettext("Deliveroo Plus"),isCurrentColor:!!I,size:h.Cs[R]})},`${n}-${t}`);case h.RE.SPACER:return a.jsx(o.default,{element:"span",spacing:`0 0 0 ${h.Ji[m]}`},`${n}-${t}`);case h.RE.COUNTDOWN:return a.jsx(d.A,{condition:!N&&!F,wrapper:e=>c.colorToken?a.jsx(w.default,{colorToken:c.colorToken,children:e}):a.jsx("span",{style:{color:c.hex},children:e}),children:a.jsx(y.A,{endsAt:parseInt(v,10),size:r||h.p7[u],isBold:_,prefixMinutes:!0,...x.v(c)})},`${n}-${t}`);case h.RE.TAG:return a.jsx($,{backgroundColor:P,spans:L,target:g},n);default:return null}})},j=e=>{let{typeName:t}=e;return t===h.RE.TEXT},F=e=>{let{typeName:t}=e;return t===h.RE.COUNTDOWN},q=e=>j(e)||F(e);N.propTypes={spans:I().arrayOf(I().shape({key:I().string.isRequired,typeName:I().oneOf(Object.values(h.RE)).isRequired,text:(0,R.default)(I().string,j),size:(0,R.default)(I().oneOf(Object.keys(h.p7)),q),color:(0,R.default)(I().shape({hex:I().string.isRequired}),q),isBold:(0,R.default)(I().bool,q),icon:(0,R.default)(I().shape({name:I().string.isRequired,size:I().string.isRequired,color:I().shape({hex:I().string.isRequired})}),(e=>{let{typeName:t}=e;return t===h.RE.ICON})&&!(e=>e.spanIcon)),spanIcon:I().shape({name:I().string.isRequired,size:I().string.isRequired,color:I().shape({hex:I().string.isRequired})}),width:(0,R.default)(I().oneOf(Object.keys(h.Ji)),e=>{let{typeName:t}=e;return t===h.RE.SPACER}),endsAt:(0,R.default)(I().string,F),backgroundColor:I().shape({hex:I().string.isRequired}),uiSpans:(0,R.default)(I().array,e=>{let{typeName:t}=e;return t===h.RE.TAG})})).isRequired,sizeOverride:I().oneOfType([I().oneOf(Object.values(h.p7)),I().shape({mobile:I().oneOf(Object.values(h.p7)),tablet:I().oneOf(Object.values(h.p7)),desktop:I().oneOf(Object.values(h.p7))})]),handleTarget:I().func};let W=N;var z=r(43331),V=r(60061),B=r(10383),H=r(94943),G=r(5451),Y=r.n(G);let J=e=>{let{children:t=null,elementRef:r,lines:i,sizeOverride:l,spacing:u,adjacentVerticalSpacing:c,isFlexAlignment:p=!1,isPlaceholder:g=!1,placeholderClassName:m="",handleTarget:f}=e;return g?(0,a.jsx)(s.default,{placeholderClassName:m,isPlaceholder:!0}):(0,a.jsx)(a.Fragment,{children:i?.map((e,i)=>{let{key:s,typeName:m}=e;switch(m){case h.Bz.TEXT:return a.jsx(d.A,{condition:!!e.maxLines,wrapper:t=>a.jsx("span",{className:n()({[Y().uiLineClamp]:!!e.maxLines}),style:{...e.maxLines&&{"--max-ui-lines":e.maxLines}||{}},children:t}),children:a.jsxs(o.default,{className:n()(Y()[v.L4(e.align||"START","align")],{[Y().flex]:p}),spacing:u,adjacentVerticalSpacing:c,elementRef:r,children:[t?.(i),a.jsx(W,{spans:e.spans,sizeOverride:l,handleTarget:f})]},s)},s);case h.Bz.TITLE:return a.jsx(_,{text:e.text||"",color:e.color,isPlaceholder:g,maxLines:2,isHeading:!1},s);default:return null}})})},X=e=>function(t){let r=(0,H.j)(),i=(0,V.Ay)();return(0,a.jsx)(e,{handleTarget:(e,t)=>{t&&r((0,z.NC)(t)),i(e)},...t})},Q=X(J),K=e=>function(t){let r=(0,B.Ay)();return(0,a.jsx)(e,{handleTarget:e=>{r(e)},...t})},Z=K(J),ee=J},99700:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var a=r(62540),i=r(62688),n=r.n(i),o=r(4452),s=r.n(o),l=r(22304),d=r(6394),u=r.n(d);let c=e=>{let{children:t=null,align:r="left",position:i,rightOffset:n,isPlaceholder:o=!1,customPopoverWrapper:d,theme:c="light"}=e,p={};n&&(p.insetInlineEnd=`${n}px`);let g=s()(u().popoverWrapper,u()[r],{[u()[i]]:!!i,[u().dark]:"dark"===c}),m=o?(0,a.jsx)("div",{className:u().loadingState,children:(0,a.jsx)(l.default,{type:"primary",size:24})}):t;return(0,a.jsx)("div",{className:g,children:d?d(m):(0,a.jsx)("div",{className:u().popover,style:p,children:m})})};c.propTypes={children:n().node.isRequired,align:n().oneOf(["left","right"]),position:n().oneOf(["top"]),rightOffset:n().number,isPlaceholder:n().bool,customPopoverWrapper:n().func,theme:n().oneOf(["dark","light"])};let p=c},69487:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(62540),i=r(63696),n=r(62688),o=r.n(n),s=r(99700),l=r(4927),d=r.n(l);class u extends i.Component{componentDidMount(){window.addEventListener("click",this.onWindowClick),window.addEventListener("touchend",this.onWindowClick)}componentWillUnmount(){window.removeEventListener("click",this.onWindowClick),window.removeEventListener("touchend",this.onWindowClick)}render(){let{align:e,position:t,rightOffset:r,isPlaceholder:i,customPopoverWrapper:n,theme:o}=this.props;return(0,a.jsxs)("div",{className:d().triggerContainer,ref:e=>{this.dropdown=e},children:[this.props.renderTrigger&&this.props.renderTrigger(this.onToggle),this.state.isOpen&&(0,a.jsx)(s.A,{position:t,align:e,rightOffset:r,isPlaceholder:i,customPopoverWrapper:n,theme:o,children:this.props.renderContent(this.onClose)})]})}constructor(...e){super(...e),this.state={isOpen:this.props.defaultOpen},this.onWindowClick=e=>{this.state.isOpen&&!this.dropdown.contains(e.target)&&this.props.shouldDismissOnWindowClick&&(e.preventDefault(),this.onClose(),this.props.onPopoverClose())},this.onClose=()=>{this.setState({isOpen:!1})},this.onToggle=()=>{this.setState({isOpen:!this.state.isOpen})}}}u.propTypes={align:o().oneOf(["left","right"]),position:o().oneOf(["top"]),rightOffset:o().number,renderContent:o().func.isRequired,renderTrigger:o().func,onPopoverClose:o().func,isPlaceholder:o().bool,customPopoverWrapper:o().func,defaultOpen:o().bool,theme:o().oneOf(["dark","light"]),shouldDismissOnWindowClick:o().bool},u.defaultProps={align:"left",position:void 0,rightOffset:void 0,onPopoverClose:()=>{},renderTrigger:void 0,isPlaceholder:!1,customPopoverWrapper:void 0,defaultOpen:!1,theme:"light",shouldDismissOnWindowClick:!0};let c=u},53839:e=>{e.exports={popoverWrapper:"Tooltip-370e8543712074b0",popoverInner:"Tooltip-3969da283d570a87"}},22582:e=>{e.exports={uiLineClamp:"UITitleLine-32d3d8b8f1d45d5f",headingWithLineClamp:"UITitleLine-376aeaed5a0a2114"}},5451:e=>{e.exports={alignStart:"UILines-eb427a2507db75b3",flex:"UILines-32dccbea0804e3af",alignCentre:"UILines-558487250abed979",alignEnd:"UILines-d8a77e65fe818cd4",uiLineClamp:"UILines-b4ef7338859b08ef"}},54345:e=>{e.exports={plusLogo:"UISpans-27b5c8a3ee4fe7b3",uiSpanTag:"UISpans-cab905c64f8fc628"}},6394:e=>{e.exports={popoverWrapper:"Popover-30abb84cea069015",popover:"Popover-d4681b5b395557a3",fadeIn:"Popover-aa80cacddcfc6eae",top:"Popover-85ab2bae47bcbfa8",loadingState:"Popover-7cb61e00761c672d",right:"Popover-a061fc5d7f1ba310",left:"Popover-2417e3fe329d88db",dark:"Popover-7e99a6064f748701",fadeOut:"Popover-1c7e2ac1229c2f40",fadeInUp:"Popover-222e369e5547e83f",appear:"Popover-2eaea63d45ffb19b",disappear:"Popover-c1aa2bbb730d1ea3",slideUp:"Popover-fe3fe5cf97c52482",wobble:"Popover-26b014e0865a8271",spinning:"Popover-ae82937af879ade4","order-status-progress-bar-pulse":"Popover-4980db8916a6c737","live-order-indicator-ripple":"Popover-ac9198932b0912c0","live-order-indicator-pulse":"Popover-826a70482bcecd22",wave:"Popover-fef986ac595c1c64"}},4927:e=>{e.exports={triggerContainer:"PopoverManager-e373249d3714e14a"}}}]);
//# sourceMappingURL=329-81777a185349604e.js.map